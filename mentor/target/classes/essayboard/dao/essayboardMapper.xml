<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="essaySQL">
	
	<!-- 에세이 멘토 리스트 출력 -->
	<!-- <select id="assayboardList" resultType="assay">
		
	</select> -->
	<!-- 에세이 리스트 출력 -->
	<select id="essayboardList" parameterType="Map" resultType="essay">
		SELECT
			*
		FROM
			(SELECT
				rownum rn, tt.*from
			(SELECT
				seq
			  ,	name
			  , company
			  , title
			  , content
			  , logtime
			  , job_type
			 FROM
			 	dumy d, job j
			 WHERE
			 	d.job_code = j.job_code 
			 order by seq desc)tt)
		WHERE
			 <![CDATA[
	         	rn >= #{startNum} and rn <= #{endNum}
			 ]]>
	</select>
	
	<!-- 에세이 글쓰기 -->
	<insert id="essayboardWrite" parameterType="java.util.Map">
		INSERT
			into dumy
		VALUES(dumy_seq.nextval
			, #{name, jdbcType=VARCHAR}
			, #{company, jdbcType=VARCHAR}
			, #{title, jdbcType=VARCHAR}
			, #{content, jdbcType=VARCHAR}
			, #{job_code, jdbcType=VARCHAR}
			, sysdate
		)
	</insert>
	
	<!-- 직무 유형 -->
	<select id="essayjobType" parameterType="String" resultType="essay">
		SELECT
			*
		FROM
			dumy
		WHERE
			job_code = #{jobType}
	</select>
	
	<!-- 에세이 총 글 수 -->
	<select id="getTotalA" parameterType="Map" resultType="Int">
		SELECT
			count(*)
		FROM
			dumy
	</select>
	
	<!-- 에세이 멘토 바디 뷰 -->
	<select id="essaymentorBodyView" parameterType="Int" resultType="essay">
		SELECT
			*
		FROM
			dumy
		WHERE
			seq = #{seq}
	</select>
	
	<!-- 에세이 수정 -->
	<select id="essayboardModifyForm" parameterType="Int" resultType="essay">
		SELECT
			*
		FROM 
		    dumy d, job j
		WHERE
		    d.job_code = j.job_code
		AND
		    seq = #{seq} 
	</select>
	
	<!-- 에세이 수정 처리 -->
	<update id="essayboardModify" parameterType="Map">
		UPDATE
			dumy
		SET
		  	title = #{title, jdbcType=VARCHAR}
		  , company = #{company, jdbcType=VARCHAR}
		  , content = #{content, jdbcType=VARCHAR}
		  , job_code = #{job_code, jdbcType=VARCHAR}
		  , logtime = sysdate
		WHERE
		 seq = #{seq, jdbcType=INTEGER}
	</update>
	
</mapper>